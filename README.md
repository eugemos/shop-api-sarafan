## 1. Задача

Решение задачи из п.1 находится в файле `task_1.py` в корне репозитория. 

## 2. API для магазина

#### Использованные технологии

Python 3.11, Django 4.2, Django REST framework 3.15.2, djoser 2.3.1, drf-spectacular 0.27.2

### Запуск в режиме разработки

1. Клонировать репозиторий

2. Создать и активировать виртуальное окружение

   ```
   cd shop-api-sarafan/backend
   python3 -m venv venv
   source venv/bin/activate
   ```

3. Установить зависимости

   ```
   python -m pip install --upgrade pip
   pip install requirements.txt
   ```

4. Создать файл `.env` в папке `shop-api-sarafan/backend` (там же находится пример `.env.example`)

5. Применить миграции

   ```
   cd backend
   manage.py migrate
   ```

6. Теперь можно загрузить в БД фикстуры или оставить БД пустой. В проекте имеется пример фикстур в файле `shop-api-sarafan/example_data.7z`. Чтобы их применить необходимо распаковать этот файл в папку `shop-api-sarafan/backend` и выполнить в ней команду:

   ```
   manage.py loaddata example
   ```

7. Создать суперпользователя (будут запрошены его атрибуты):

   ```
   manage.py createsuperuser
   ```

8. Запустить приложение на сервере разработки:

   ````
   manage.py runserver
   ````

9. Теперь можно зайти в админку сайта `http://127.0.0.1:8000/admin/` с помощью учётных данных суперпользователя. В ней можно создать других пользователей, а также категории товаров и сами товары.
10. API сайта доступно по адресу `http://127.0.0.1:8000/api/`, при этом, по адресу `http://127.0.0.1:8000/api/schema/swagger-ui/` расположена интерактивная документация API в формате Swagger UI. API содержит следующие эндпойнты:
    1. `/api/auth/token/login/ POST` - получить токен авторизации;
    2. `/api/auth/token/logout/ POST` - уничтожить токен авторизации;
    3. `/api/cart/` - для операций над корзиной текущего пользователя в целом (требуется токен авторизации):
       - `GET` - получить корзину текущего пользователя;
       - `DELETE` - очистить корзину текущего пользователя;
    4. `/api/cart/{product_slug}/` - для операций по формированию корзины текущего пользователя (требуется токен авторизации):
       * `POST` - добавить товар в корзину, если его там ещё нет, а если уже есть, то увеличить его количество;
       * `PUT` - добавить товар в корзину, если его там ещё нет, а если уже есть, то изменить его количество;
       * `DELETE` - удалить товар из корзины;
    5. `/api/categories/  GET` - получить список всех категорий товаров с подкатегориями;
    6. `/api/products/  GET` - получить список всех товаров.

#### Тестирование

Проект содержит тесты для эндпойнтов `/api/cart/ GET` и `/api/cart/{product_slug}/ POST`.  Для их запуска необходимо выполнить команду `manage.py test` в папке `shop-api-sarafan/backend` при активированном виртуальном окружении.
